<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 í…ì„œ (tensor) ì—°ì‚° | ë”¥ëŸ¬ë‹ ê³µëµì§‘ with R</title>
  <meta name="description" content="ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ Rtorchë¥¼ ì‚¬ìš©í•˜ì—¬ ë”¥ëŸ¬ë‹ì˜ ëíŒì™•ì„ ì •ë³µí•´ë³´ì. ë³¸ê²© R ë”¥ëŸ¬ë‹ ê³µëµì§‘" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 í…ì„œ (tensor) ì—°ì‚° | ë”¥ëŸ¬ë‹ ê³µëµì§‘ with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ Rtorchë¥¼ ì‚¬ìš©í•˜ì—¬ ë”¥ëŸ¬ë‹ì˜ ëíŒì™•ì„ ì •ë³µí•´ë³´ì. ë³¸ê²© R ë”¥ëŸ¬ë‹ ê³µëµì§‘" />
  <meta name="github-repo" content="statisticsplaybook/r-torch-playbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 í…ì„œ (tensor) ì—°ì‚° | ë”¥ëŸ¬ë‹ ê³µëµì§‘ with R" />
  
  <meta name="twitter:description" content="ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ Rtorchë¥¼ ì‚¬ìš©í•˜ì—¬ ë”¥ëŸ¬ë‹ì˜ ëíŒì™•ì„ ì •ë³µí•´ë³´ì. ë³¸ê²© R ë”¥ëŸ¬ë‹ ê³µëµì§‘" />
  

<meta name="author" content="ìŠ¬ê¸°ë¡œìš´í†µê³„ìƒí™œ" />


<meta name="date" content="2021-02-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.6.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ë”¥ëŸ¬ë‹ ê³µëµì§‘ with Rtorch</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> ë“¤ì–´ê°€ë©°</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#ì„¤ì¹˜í•˜ê¸°"><i class="fa fa-check"></i><b>1.1</b> ì„¤ì¹˜í•˜ê¸°</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> ë”¥ëŸ¬ë‹ ì²«ê±¸ìŒ, í…ì„œ (tensor) ë§Œë“¤ê¸°</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#torchì™€ì˜-ì²«ë§Œë‚¨"><i class="fa fa-check"></i><b>2.1</b> <code>torch</code>ì™€ì˜ ì²«ë§Œë‚¨</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#í…ì„œ-tensor-ë§Œë“¤ê¸°"><i class="fa fa-check"></i><b>2.2</b> í…ì„œ (tensor) ë§Œë“¤ê¸°</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#ë¹ˆ-í…ì„œ-ë§Œë“¤ê¸°"><i class="fa fa-check"></i><b>2.2.1</b> ë¹ˆ í…ì„œ ë§Œë“¤ê¸°</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#ëœë¤-í…ì„œ"><i class="fa fa-check"></i><b>2.2.2</b> ëœë¤ í…ì„œ</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#ë‹¨ìœ„-í…ì„œ"><i class="fa fa-check"></i><b>2.2.3</b> ë‹¨ìœ„ í…ì„œ</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#ì˜0-í…ì„œ"><i class="fa fa-check"></i><b>2.2.4</b> ì˜(0) í…ì„œ</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#ê³ ê¸‰ê¸°ìˆ -ì˜ë¦¬í•˜ê²Œ-ë§Œë“¤ê¸°"><i class="fa fa-check"></i><b>2.3</b> ê³ ê¸‰ê¸°ìˆ : ì˜ë¦¬í•˜ê²Œ ë§Œë“¤ê¸°</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#í…ì„œ-ì§ì ‘ì„ ì–¸"><i class="fa fa-check"></i><b>2.3.1</b> í…ì„œ ì§ì ‘ì„ ì–¸</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#ì—°ì‚°ì-ì‚¬ìš©"><i class="fa fa-check"></i><b>2.3.2</b> <code>:</code> ì—°ì‚°ì ì‚¬ìš©</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#seq-í•¨ìˆ˜-ì‚¬ìš©"><i class="fa fa-check"></i><b>2.3.3</b> <code>seq()</code> í•¨ìˆ˜ ì‚¬ìš©</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro.html"><a href="intro.html#ì—°ì‚°ì-ì‚¬ìš©-1"><i class="fa fa-check"></i><b>2.3.4</b> <code>%&gt;%</code> ì—°ì‚°ì ì‚¬ìš©</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#í…ì„œì™€-í–‰ë ¬ì€-ê°™ì„ê¹Œ"><i class="fa fa-check"></i><b>2.4</b> í…ì„œì™€ í–‰ë ¬ì€ ê°™ì„ê¹Œ?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="operation.html"><a href="operation.html"><i class="fa fa-check"></i><b>3</b> í…ì„œ (tensor) ì—°ì‚°</a>
<ul>
<li class="chapter" data-level="3.1" data-path="operation.html"><a href="operation.html#í† ì¹˜-torch-ë¶ˆëŸ¬ì˜¤ê¸°-ë°-ì¤€ë¹„ë¬¼-ì¤€ë¹„"><i class="fa fa-check"></i><b>3.1</b> í† ì¹˜ (torch) ë¶ˆëŸ¬ì˜¤ê¸° ë° ì¤€ë¹„ë¬¼ ì¤€ë¹„</a></li>
<li class="chapter" data-level="3.2" data-path="operation.html"><a href="operation.html#í…ì„œì˜-ì—°ì‚°"><i class="fa fa-check"></i><b>3.2</b> í…ì„œì˜ ì—°ì‚°</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="operation.html"><a href="operation.html#í˜•type-ë³€í™˜"><i class="fa fa-check"></i><b>3.2.1</b> í˜•(type) ë³€í™˜</a></li>
<li class="chapter" data-level="3.2.2" data-path="operation.html"><a href="operation.html#ëª¨ì–‘-ë³€í™˜"><i class="fa fa-check"></i><b>3.2.2</b> ëª¨ì–‘ ë³€í™˜</a></li>
<li class="chapter" data-level="3.2.3" data-path="operation.html"><a href="operation.html#ë§ì…ˆê³¼-ëº„ì…ˆ"><i class="fa fa-check"></i><b>3.2.3</b> ë§ì…ˆê³¼ ëº„ì…ˆ</a></li>
<li class="chapter" data-level="3.2.4" data-path="operation.html"><a href="operation.html#ìƒìˆ˜ì™€ì˜-ì—°ì‚°"><i class="fa fa-check"></i><b>3.2.4</b> ìƒìˆ˜ì™€ì˜ ì—°ì‚°</a></li>
<li class="chapter" data-level="3.2.5" data-path="operation.html"><a href="operation.html#ì œê³±ê·¼ê³¼-ë¡œê·¸"><i class="fa fa-check"></i><b>3.2.5</b> ì œê³±ê·¼ê³¼ ë¡œê·¸</a></li>
<li class="chapter" data-level="3.2.6" data-path="operation.html"><a href="operation.html#í…ì„œì˜-ê³±ì…ˆ"><i class="fa fa-check"></i><b>3.2.6</b> í…ì„œì˜ ê³±ì…ˆ</a></li>
<li class="chapter" data-level="3.2.7" data-path="operation.html"><a href="operation.html#í…ì„œì˜-ì „ì¹˜transpose"><i class="fa fa-check"></i><b>3.2.7</b> í…ì„œì˜ ì „ì¹˜(transpose)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/statisticsplaybook/r-torch-playbook" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ë”¥ëŸ¬ë‹ ê³µëµì§‘ with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="operation" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> í…ì„œ (tensor) ì—°ì‚°</h1>
<p>ì§€ë‚œ ì±•í„°ì—ì„œ ìš°ë¦¬ëŠ” í…ì„œê°€ í–‰ë ¬ì˜ ì—°ì‚°ì— ì ìš©ë˜ëŠ” <code>%*%</code>ê³¼ í˜¸í™˜ì´ ë˜ì§€ ì•ŠëŠ” ë‹¤ëŠ” ê²ƒì„ ì•Œê²Œë˜ì—ˆë‹¤. ì´ë²ˆ ì±•í„°ì—ì„œëŠ” í…ì„œë“¤ì˜ ì—°ì‚°ì— ëŒ€í•˜ì—¬ ì•Œì•„ë³´ë„ë¡ í•˜ì.</p>
<div id="í† ì¹˜-torch-ë¶ˆëŸ¬ì˜¤ê¸°-ë°-ì¤€ë¹„ë¬¼-ì¤€ë¹„" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> í† ì¹˜ (torch) ë¶ˆëŸ¬ì˜¤ê¸° ë° ì¤€ë¹„ë¬¼ ì¤€ë¹„</h2>
<p>í† ì¹˜ (torch) ë¥¼ ë¶ˆëŸ¬ì˜¤ê³ , ì´ë²ˆ ì±•í„°ì— ì‚¬ìš©ë  í…ì„œ A, B, ê·¸ë¦¬ê³  Cë¥¼ ì¤€ë¹„í•˜ì. ì§€ë‚œ ì±•í„°ì—ì„œ ë°°ìš´ ë‚œìˆ˜ë¥¼ ì´ìš©í•œ í…ì„œë„ ë§Œë“¤ ì˜ˆì •ì´ë‹ˆ ë‚œìˆ˜ë¥¼ ê³ ì •í•œë‹¤.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="operation.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(torch)</span>
<span id="cb1-2"><a href="operation.html#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="operation.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ë‚œìˆ˜ ìƒì„± ì‹œë“œ ê³ ì • </span></span>
<span id="cb1-4"><a href="operation.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">torch_manual_seed</span>(<span class="dv">2021</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="operation.html#cb2-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">torch_tensor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb2-2"><a href="operation.html#cb2-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">torch_rand</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb2-3"><a href="operation.html#cb2-3" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">torch_rand</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb2-4"><a href="operation.html#cb2-4" aria-hidden="true" tabindex="-1"></a>A; B; C</span></code></pre></div>
<pre><code>## torch_tensor
##  1
##  2
##  3
##  4
##  5
##  6
## [ CPULongType{6} ]</code></pre>
<pre><code>## torch_tensor
##  0.5134  0.7426  0.7159
##  0.5705  0.1653  0.0443
## [ CPUFloatType{2,3} ]</code></pre>
<pre><code>## torch_tensor
## (1,.,.) = 
##   0.9628  0.2943
##   0.0992  0.8096
##   0.0169  0.8222
## 
## (2,.,.) = 
##   0.1242  0.7489
##   0.3608  0.5131
##   0.2959  0.7834
## [ CPUFloatType{2,3,2} ]</code></pre>
<p>ë§Œë“¤ì–´ì§„ ì„¸ ê°œì˜ í…ì„œ ê²°ê³¼ë¥¼ ì‚´í´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<ol style="list-style-type: decimal">
<li>í…ì„œ A: ì •ìˆ˜ë“¤ë¡œ êµ¬ì„±ì´ ë˜ì–´ìˆê³ , 6ê°œì˜ ì›ì†Œë“¤ì´ ë²¡í„°ë¥¼ ì´ë£¨ê³  ìˆë‹¤.</li>
<li>í…ì„œ B: ì‹¤ìˆ˜ë“¤ë¡œ êµ¬ì„±ì´ ë˜ì–´ìˆê³ , ë˜‘ê°™ì´ 6ê°œì˜ ì›ì†Œë“¤ì´ ìˆì§€ë§Œ, ëª¨ì–‘ì´ 4í–‰ 3ì—´ì¸ 2ì°¨ì› í–‰ë ¬ì˜ ëª¨ì–‘ì„ í•˜ê³  ìˆë‹¤.</li>
<li>í…ì„œ C: ì‹¤ìˆ˜ë“¤ë¡œ êµ¬ì„±ì´ ë˜ì–´ìˆê³ , ì´ ì›ì†Œ ê°¯ìˆ˜ëŠ” 12ê°œì§€ë§Œ, ëª¨ì–‘ì€ 3í–‰ 2ì—´ì˜ í–‰ë ¬ì´ ë‘ê°œê°€ ìŒ“ì—¬ì§„ ê¼´ì˜ 3ì°¨ì› ë°°ì—´ (array) ì´ë‹¤.</li>
</ol>
</div>
<div id="í…ì„œì˜-ì—°ì‚°" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> í…ì„œì˜ ì—°ì‚°</h2>
<div id="í˜•type-ë³€í™˜" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> í˜•(type) ë³€í™˜</h3>
<p>ë¨¼ì € ì£¼ëª©í•´ì•¼ í•  ê²ƒì€ ë°”ë¡œ í…ì„œ Aì™€ Bì˜ ìë£Œí˜•ì´ ë‹¤ë¥´ë‹¤ëŠ” ê²ƒì´ë‹¤. ì´ê²Œ ë¬´ìŠ¨ëœ»ì´ëƒë©´ Aì—ëŠ” ì •ìˆ˜ë§Œì´ ë‹´ê¸¸ ìˆ˜ ìˆê³ , Bì—ëŠ” ì‹¤ìˆ˜ë§Œì´ ë‹´ê¸¸ ìˆ˜ ìˆë„ë¡ ì„¤ê³„ê°€ ë˜ì–´ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ì•ì—ì„œ í™•ì¸í•œ ìë£Œí˜•ì„ ì¢€ ë” ëª…í™•í•˜ê²Œ í™•ì¸í•˜ê¸° ìœ„í•´ì„œëŠ” <code>type()</code> ì‚¬ìš©í•œë‹¤.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="operation.html#cb6-1" aria-hidden="true" tabindex="-1"></a>A<span class="sc">$</span>dtype</span></code></pre></div>
<pre><code>## torch_Long</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="operation.html#cb8-1" aria-hidden="true" tabindex="-1"></a>B<span class="sc">$</span>dtype</span></code></pre></div>
<pre><code>## torch_Float</code></pre>
<p>í…ì„œ Aë¥¼ ì‹¤ìˆ˜í˜• í…ì„œë¡œ ë°”ê¿”ë³´ì. í…ì„œì˜ í˜•ì„ ë³€í™˜í•  ë•Œì—ëŠ” Aí…ì„œ ì•ˆì— ì†ì„±ìœ¼ë¡œ ë“¤ì–´ê°€ìˆëŠ” to() í•¨ìˆ˜ë¥¼ ì‚¬ìš© (ì¢€ ë” ì–´ë ¤ìš´ ê´€ì ì—ì„œëŠ” OOPì˜ methodë¥¼ ì‚¬ìš©) í•´ì„œ ë°”ê¿”ì¤„ ìˆ˜ ìˆë‹¤.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="operation.html#cb10-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> A<span class="sc">$</span><span class="fu">to</span>(<span class="at">dtype =</span> <span class="fu">torch_double</span>())</span>
<span id="cb10-2"><a href="operation.html#cb10-2" aria-hidden="true" tabindex="-1"></a>A</span></code></pre></div>
<pre><code>## torch_tensor
##  1
##  2
##  3
##  4
##  5
##  6
## [ CPUDoubleType{6} ]</code></pre>
<p>torchì—ëŠ” ì •ë§ ë§ì€ ìë£Œí˜•ì´ ìˆëŠ”ë°, ê·¸ ëª©ë¡ì€ <a href="https://torch.mlverse.org/docs/reference/torch_dtype.html">ë‹¤ìŒ</a>ì„ ì°¸ê³ í•˜ì.</p>
</div>
<div id="ëª¨ì–‘-ë³€í™˜" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> ëª¨ì–‘ ë³€í™˜</h3>
<p>ì•ì—ì„œ í…ì„œ Aë¥¼ Bì™€ ê°™ì€ ì‹¤ìˆ˜ë¥¼ ë‹´ì„ ìˆ˜ ìˆëŠ” í˜•ìœ¼ë¡œ ë°”ê¾¸ì—ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì´ ë‘ ê°œë¥¼ ë”í•  ìˆ˜ ìˆì„ê¹Œ? ë‹µì€ â€œì•„ë‹ˆì˜¬ì‹œë‹¤.â€ ì´ë‹¤. ì™œëƒí•˜ë©´ ëª¨ì–‘ì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì´ë‹¤.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="operation.html#cb12-1" aria-hidden="true" tabindex="-1"></a>A <span class="sc">+</span> B</span></code></pre></div>
<pre><code>## Error in (function (self, other, alpha) : The size of tensor a (6) must match the size of tensor b (3) at non-singleton dimension 1
## Exception raised from infer_size at ../aten/src/ATen/ExpandUtils.cpp:24 (most recent call first):
## frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;) + 0x69 (0x7f086041eb89 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libc10.so)
## frame #1: at::infer_size(c10::ArrayRef&lt;long&gt;, c10::ArrayRef&lt;long&gt;) + 0x552 (0x7f084ff6d382 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so)
## frame #2: at::TensorIterator::compute_shape(at::TensorIteratorConfig const&amp;) + 0xde (0x7f085046fc2e in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so)
## frame #3: at::TensorIterator::build(at::TensorIteratorConfig&amp;) + 0x64 (0x7f08504721e4 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so)
## frame #4: at::TensorIterator::TensorIterator(at::TensorIteratorConfig&amp;) + 0xdd (0x7f085047299d in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so)
## frame #5: at::TensorIterator::binary_op(at::Tensor&amp;, at::Tensor const&amp;, at::Tensor const&amp;) + 0x130 (0x7f0850472b30 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so)
## frame #6: at::native::add(at::Tensor const&amp;, at::Tensor const&amp;, c10::Scalar) + 0x53 (0x7f0850125bc3 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so)
## frame #7: &lt;unknown function&gt; + 0x13311bd (0x7f085078c1bd in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so)
## frame #8: &lt;unknown function&gt; + 0xaf2045 (0x7f084ff4d045 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so)
## frame #9: at::Tensor c10::Dispatcher::callWithDispatchKey&lt;at::Tensor, at::Tensor const&amp;, at::Tensor const&amp;, c10::Scalar&gt;(c10::TypedOperatorHandle&lt;at::Tensor (at::Tensor const&amp;, at::Tensor const&amp;, c10::Scalar)&gt; const&amp;, c10::DispatchKey, at::Tensor const&amp;, at::Tensor const&amp;, c10::Scalar) const + 0x27f (0x7f085093781f in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so)
## frame #10: at::add(at::Tensor const&amp;, at::Tensor const&amp;, c10::Scalar) + 0x123 (0x7f085082dfd3 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so)
## frame #11: &lt;unknown function&gt; + 0x2a0f2bb (0x7f0851e6a2bb in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so)
## frame #12: &lt;unknown function&gt; + 0xaf2045 (0x7f084ff4d045 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so)
## frame #13: at::Tensor c10::Dispatcher::callWithDispatchKey&lt;at::Tensor, at::Tensor const&amp;, at::Tensor const&amp;, c10::Scalar&gt;(c10::TypedOperatorHandle&lt;at::Tensor (at::Tensor const&amp;, at::Tensor const&amp;, c10::Scalar)&gt; const&amp;, c10::DispatchKey, at::Tensor const&amp;, at::Tensor const&amp;, c10::Scalar) const + 0x27f (0x7f085093781f in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so)
## frame #14: at::add(at::Tensor const&amp;, at::Tensor const&amp;, c10::Scalar) + 0x123 (0x7f085082dfd3 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so)
## frame #15: _lantern_add_tensor_tensor_scalar + 0x64 (0x7f08607a00e4 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/liblantern.so)
## frame #16: cpp_torch_namespace_add_self_Tensor_other_Tensor(Rcpp::XPtr&lt;XPtrTorchTensor, Rcpp::PreserveStorage, &amp;(void Rcpp::standard_delete_finalizer&lt;XPtrTorchTensor&gt;(XPtrTorchTensor*)), false&gt;, Rcpp::XPtr&lt;XPtrTorchTensor, Rcpp::PreserveStorage, &amp;(void Rcpp::standard_delete_finalizer&lt;XPtrTorchTensor&gt;(XPtrTorchTensor*)), false&gt;, Rcpp::XPtr&lt;XPtrTorchScalar, Rcpp::PreserveStorage, &amp;(void Rcpp::standard_delete_finalizer&lt;XPtrTorchScalar&gt;(XPtrTorchScalar*)), false&gt;) + 0x48 (0x7f08610e5fe8 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/libs/torchpkg.so)
## frame #17: _torch_cpp_torch_namespace_add_self_Tensor_other_Tensor + 0x9c (0x7f0860e7e00c in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/libs/torchpkg.so)
## frame #18: &lt;unknown function&gt; + 0xf9310 (0x7f0874173310 in /usr/lib/R/lib/libR.so)
## frame #19: &lt;unknown function&gt; + 0xf9826 (0x7f0874173826 in /usr/lib/R/lib/libR.so)
## frame #20: &lt;unknown function&gt; + 0x137106 (0x7f08741b1106 in /usr/lib/R/lib/libR.so)
## frame #21: Rf_eval + 0x180 (0x7f08741bd6f0 in /usr/lib/R/lib/libR.so)
## frame #22: &lt;unknown function&gt; + 0x14550f (0x7f08741bf50f in /usr/lib/R/lib/libR.so)
## frame #23: Rf_applyClosure + 0x1c7 (0x7f08741c02d7 in /usr/lib/R/lib/libR.so)
## frame #24: Rf_eval + 0x353 (0x7f08741bd8c3 in /usr/lib/R/lib/libR.so)
## frame #25: &lt;unknown function&gt; + 0xc650d (0x7f087414050d in /usr/lib/R/lib/libR.so)
## frame #26: &lt;unknown function&gt; + 0x137106 (0x7f08741b1106 in /usr/lib/R/lib/libR.so)
## frame #27: Rf_eval + 0x180 (0x7f08741bd6f0 in /usr/lib/R/lib/libR.so)
## frame #28: &lt;unknown function&gt; + 0x14550f (0x7f08741bf50f in /usr/lib/R/lib/libR.so)
## frame #29: Rf_applyClosure + 0x1c7 (0x7f08741c02d7 in /usr/lib/R/lib/libR.so)
## frame #30: &lt;unknown function&gt; + 0x13a989 (0x7f08741b4989 in /usr/lib/R/lib/libR.so)
## frame #31: Rf_eval + 0x180 (0x7f08741bd6f0 in /usr/lib/R/lib/libR.so)
## frame #32: &lt;unknown function&gt; + 0x14550f (0x7f08741bf50f in /usr/lib/R/lib/libR.so)
## frame #33: Rf_applyClosure + 0x1c7 (0x7f08741c02d7 in /usr/lib/R/lib/libR.so)
## frame #34: &lt;unknown function&gt; + 0x13a989 (0x7f08741b4989 in /usr/lib/R/lib/libR.so)
## frame #35: Rf_eval + 0x180 (0x7f08741bd6f0 in /usr/lib/R/lib/libR.so)
## frame #36: &lt;unknown function&gt; + 0x14550f (0x7f08741bf50f in /usr/lib/R/lib/libR.so)
## frame #37: Rf_applyClosure + 0x1c7 (0x7f08741c02d7 in /usr/lib/R/lib/libR.so)
## frame #38: &lt;unknown function&gt; + 0x13a989 (0x7f08741b4989 in /usr/lib/R/lib/libR.so)
## frame #39: Rf_eval + 0x180 (0x7f08741bd6f0 in /usr/lib/R/lib/libR.so)
## frame #40: &lt;unknown function&gt; + 0x14550f (0x7f08741bf50f in /usr/lib/R/lib/libR.so)
## frame #41: Rf_applyClosure + 0x1c7 (0x7f08741c02d7 in /usr/lib/R/lib/libR.so)
## frame #42: &lt;unknown function&gt; + 0x13a989 (0x7f08741b4989 in /usr/lib/R/lib/libR.so)
## frame #43: Rf_eval + 0x180 (0x7f08741bd6f0 in /usr/lib/R/lib/libR.so)
## frame #44: &lt;unknown function&gt; + 0x14550f (0x7f08741bf50f in /usr/lib/R/lib/libR.so)
## frame #45: Rf_applyClosure + 0x1c7 (0x7f08741c02d7 in /usr/lib/R/lib/libR.so)
## frame #46: &lt;unknown function&gt; + 0x12d83b (0x7f08741a783b in /usr/lib/R/lib/libR.so)
## frame #47: &lt;unknown function&gt; + 0x9021b (0x7f087410a21b in /usr/lib/R/lib/libR.so)
## frame #48: Rf_eval + 0x706 (0x7f08741bdc76 in /usr/lib/R/lib/libR.so)
## frame #49: &lt;unknown function&gt; + 0x149782 (0x7f08741c3782 in /usr/lib/R/lib/libR.so)
## frame #50: &lt;unknown function&gt; + 0x137106 (0x7f08741b1106 in /usr/lib/R/lib/libR.so)
## frame #51: Rf_eval + 0x180 (0x7f08741bd6f0 in /usr/lib/R/lib/libR.so)
## frame #52: &lt;unknown function&gt; + 0x14550f (0x7f08741bf50f in /usr/lib/R/lib/libR.so)
## frame #53: Rf_applyClosure + 0x1c7 (0x7f08741c02d7 in /usr/lib/R/lib/libR.so)
## frame #54: &lt;unknown function&gt; + 0x13a989 (0x7f08741b4989 in /usr/lib/R/lib/libR.so)
## frame #55: Rf_eval + 0x180 (0x7f08741bd6f0 in /usr/lib/R/lib/libR.so)
## frame #56: &lt;unknown function&gt; + 0x1440ac (0x7f08741be0ac in /usr/lib/R/lib/libR.so)
## frame #57: Rf_eval + 0x454 (0x7f08741bd9c4 in /usr/lib/R/lib/libR.so)
## frame #58: &lt;unknown function&gt; + 0x14a22c (0x7f08741c422c in /usr/lib/R/lib/libR.so)
## frame #59: &lt;unknown function&gt; + 0x1871fd (0x7f08742011fd in /usr/lib/R/lib/libR.so)
## frame #60: &lt;unknown function&gt; + 0x1353c4 (0x7f08741af3c4 in /usr/lib/R/lib/libR.so)
## frame #61: Rf_eval + 0x180 (0x7f08741bd6f0 in /usr/lib/R/lib/libR.so)
## frame #62: &lt;unknown function&gt; + 0x14550f (0x7f08741bf50f in /usr/lib/R/lib/libR.so)
## frame #63: Rf_applyClosure + 0x1c7 (0x7f08741c02d7 in /usr/lib/R/lib/libR.so)</code></pre>
<p>ëª¨ì–‘ì´ ë‹¤ë¥¸ í…ì„œë¥¼ ë”í•˜ë ¤ê³  í•˜ë©´ Rì€ ìœ„ì—ì„œ ë³´ë“¯ ë„ˆë¬´ë‚˜ ë§ì€ ì—ëŸ¬ë¥¼ ìŸì•„ë‚¸ë‹¤. ëª¨ì–‘ì´ ë‹¤ë¥¸ ë‘ í…ì„œë¥¼ ë”í•˜ê¸° ìœ„í•´ì„œëŠ” ëª¨ì–‘ì„ ê°™ê²Œ ë§ì¶°ì¤˜ì•¼ í•œë‹¤. Aì˜ ëª¨ì–‘ì„ Bì˜ ëª¨ì–‘ê³¼ ê°™ì´ ë°”ê¿”ë³´ë„ë¡ í•˜ì. ëª¨ì–‘ì„ ë°”ê¿€ë•ŒëŠ” <code>view()</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê³ , ì•ˆì— ëª¨ì–‘ì˜ í˜•íƒœë¥¼ ë²¡í„° í˜•ì‹ìœ¼ë¡œ ì§šì–´ ë„£ëŠ”ë‹¤ëŠ” ê²ƒì„ ê¸°ì–µí•˜ì.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="operation.html#cb14-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> A<span class="sc">$</span><span class="fu">view</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb14-2"><a href="operation.html#cb14-2" aria-hidden="true" tabindex="-1"></a>A</span></code></pre></div>
<pre><code>## torch_tensor
##  1  2  3
##  4  5  6
## [ CPUDoubleType{2,3} ]</code></pre>
</div>
<div id="ë§ì…ˆê³¼-ëº„ì…ˆ" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> ë§ì…ˆê³¼ ëº„ì…ˆ</h3>
<p>ì•ì—ì„œ í˜•(type)ê³¼ ëª¨ì–‘(shape)ê¹Œì§€ ë§ì¶°ë†¨ìœ¼ë‹ˆ, í…ì„œë¼ë¦¬ì˜ ë§ì…ˆê³¼ ëº„ì…ˆì„ í•  ìˆ˜ ìˆë‹¤.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="operation.html#cb16-1" aria-hidden="true" tabindex="-1"></a>A <span class="sc">+</span> B</span></code></pre></div>
<pre><code>## torch_tensor
##  1.5134  2.7426  3.7159
##  4.5705  5.1653  6.0443
## [ CPUDoubleType{2,3} ]</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="operation.html#cb18-1" aria-hidden="true" tabindex="-1"></a>A <span class="sc">-</span> B</span></code></pre></div>
<pre><code>## torch_tensor
##  0.4866  1.2574  2.2841
##  3.4295  4.8347  5.9557
## [ CPUDoubleType{2,3} ]</code></pre>
<p>ì‚¬ì‹¤, í…ì„œë¼ë¦¬ì˜ ì—°ì‚°ì€ <strong>ëª¨ì–‘ë§Œ ë§ìœ¼ë©´ ê°€ëŠ¥</strong>í•˜ë‹¤. ì¦‰, ë‹¤ìŒì˜ ì—°ì‚°ì´ ì„±ë¦½í•œë‹¤.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="operation.html#cb20-1" aria-hidden="true" tabindex="-1"></a>A_ <span class="ot">&lt;-</span> A<span class="sc">$</span><span class="fu">to</span>(<span class="at">dtype =</span> <span class="fu">torch_long</span>())</span>
<span id="cb20-2"><a href="operation.html#cb20-2" aria-hidden="true" tabindex="-1"></a>A_ <span class="sc">+</span> B</span></code></pre></div>
<pre><code>## torch_tensor
##  1.5134  2.7426  3.7159
##  4.5705  5.1653  6.0443
## [ CPUFloatType{2,3} ]</code></pre>
<p>ê²°ê³¼ì—ì„œ ì•Œ ìˆ˜ ìˆë“¯, ì •ìˆ˜ë¥¼ ë‹´ì„ ìˆ˜ ìˆëŠ” í…ì„œì™€ ì‹¤ìˆ˜ë¥¼ ë‹´ì„ ìˆ˜ ìˆëŠ” í…ì„œë¥¼ ë”í•˜ë©´, ê²°ê³¼ëŠ” ì‹¤ìˆ˜ë¥¼ ë‹´ì„ ìˆ˜ ìˆëŠ” í…ì„œë¡œ ë°˜í™˜ì´ ëœë‹¤. í•˜ì§€ë§Œ, í•„ìëŠ” ì´ëŸ¬í•œ ì½”ë”©ì€ í”¼í•´ì•¼ í•œë‹¤ê³  ìƒê°í•œë‹¤. ì¦‰, ëª¨ë“  ì—°ì‚°ì„ í•  ê²½ìš°, ëª…ì‹œì ìœ¼ë¡œ í˜•ë³€í™˜ì„ í•œ í›„ ì—°ì‚°ì„ í•  ê²ƒì„ ê¶Œí•œë‹¤. ì™œëƒí•˜ë©´, ì–¸ì œë‚˜ ìš°ë¦¬ëŠ” ì½”ë“œë¥¼ ë‹¤ë¥¸ ì‚¬ëŒì´ ë³´ì•˜ì„ ë•Œ, ì´í•´í•˜ê¸° ì‰½ë„ë¡ ì§œëŠ” ê²ƒì„ ì¶”êµ¬í•´ì•¼ í•œë‹¤. (ì½”ë“œëŠ” í•˜ë‚˜ì˜ ìì‹ ì˜ ìƒê°ì„ ì ì€ ê¸€ì´ë‹¤.)</p>
</div>
<div id="ìƒìˆ˜ì™€ì˜-ì—°ì‚°" class="section level3" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> ìƒìˆ˜ì™€ì˜ ì—°ì‚°</h3>
<p>Rì—ì„œì™€ ë§ˆì°¬ê°€ì§€ë¡œ, í…ì„œì™€ ìƒìˆ˜ì™€ì˜ ì‚¬ì¹™ì—°ì‚°ì€ ê° ì›ì†Œì— ì ìš©ë˜ëŠ” ê²ƒì„ í™•ì¸í•˜ì.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="operation.html#cb22-1" aria-hidden="true" tabindex="-1"></a>A <span class="sc">+</span> <span class="dv">2</span></span></code></pre></div>
<pre><code>## torch_tensor
##  3  4  5
##  6  7  8
## [ CPUDoubleType{2,3} ]</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="operation.html#cb24-1" aria-hidden="true" tabindex="-1"></a>B<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## torch_tensor
##  0.2636  0.5514  0.5125
##  0.3254  0.0273  0.0020
## [ CPUFloatType{2,3} ]</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="operation.html#cb26-1" aria-hidden="true" tabindex="-1"></a>A <span class="sc">%/%</span> <span class="dv">3</span></span></code></pre></div>
<pre><code>## torch_tensor
##  0  0  1
##  1  1  2
## [ CPUDoubleType{2,3} ]</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="operation.html#cb28-1" aria-hidden="true" tabindex="-1"></a>A <span class="sc">%%</span> <span class="dv">3</span></span></code></pre></div>
<pre><code>## torch_tensor
##  1  2  0
##  1  2  0
## [ CPUDoubleType{2,3} ]</code></pre>
</div>
<div id="ì œê³±ê·¼ê³¼-ë¡œê·¸" class="section level3" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> ì œê³±ê·¼ê³¼ ë¡œê·¸</h3>
<p>ì œê³±ê·¼(square root)ë‚˜ ë¡œê·¸(log) í•¨ìˆ˜ ì—­ì‹œ ê° ì›ì†Œë³„ ì ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="operation.html#cb30-1" aria-hidden="true" tabindex="-1"></a>A</span></code></pre></div>
<pre><code>## torch_tensor
##  1  2  3
##  4  5  6
## [ CPUDoubleType{2,3} ]</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="operation.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">torch_sqrt</span>(A)</span></code></pre></div>
<pre><code>## torch_tensor
##  1.0000  1.4142  1.7321
##  2.0000  2.2361  2.4495
## [ CPUDoubleType{2,3} ]</code></pre>
<p>ìœ„ì˜ ì—°ì‚°ì´ ì—ëŸ¬ê°€ ë‚˜ëŠ” ì´ìœ ëŠ” Aê°€ ì •ìˆ˜ë¥¼ ë‹´ëŠ” í…ì„œì˜€ëŠ”ë°, ì—°ì‚°ì„ ìˆ˜í–‰í•œ í›„ì— ì‹¤ìˆ˜ê°€ ë‹´ê²¨ì ¸ì„œ ë‚˜ì˜¤ëŠ” ì—ëŸ¬ì´ë‹¤. Rê³¼ëŠ” ì‚¬ë­‡ë‹¤ë¥¸ ì˜ˆë¯¼í•œ ì•„ì´ <code>torch</code>ë¥¼ ìœ„í•´ í˜•ì„ ë°”ê¿”ì¤€ í›„ì— ì—°ì‚°ì„ ì‹¤í–‰í•˜ë„ë¡ í•˜ì.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="operation.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">torch_sqrt</span>(A<span class="sc">$</span><span class="fu">to</span>(<span class="at">dtype =</span> <span class="fu">torch_double</span>()))</span></code></pre></div>
<pre><code>## torch_tensor
##  1.0000  1.4142  1.7321
##  2.0000  2.2361  2.4495
## [ CPUDoubleType{2,3} ]</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="operation.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">torch_log</span>(B)</span></code></pre></div>
<pre><code>## torch_tensor
## -0.6667 -0.2977 -0.3342
## -0.5613 -1.8002 -3.1166
## [ CPUFloatType{2,3} ]</code></pre>
</div>
<div id="í…ì„œì˜-ê³±ì…ˆ" class="section level3" number="3.2.6">
<h3><span class="header-section-number">3.2.6</span> í…ì„œì˜ ê³±ì…ˆ</h3>
<p>í…ì„œì˜ ê³±ì…ˆ ì—­ì‹œ ëª¨ì–‘ì´ ë§ì•„ì•¼ í•˜ë¯€ë¡œ, 3í–‰ 2ì—´ì´ ë‘ê°œê°€ ë¶™ì–´ìˆëŠ” Cì—ì„œ ì•ì— í•œì¥ì„ ë–¼ì–´ë‚´ë„ë¡ í•˜ì.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="operation.html#cb38-1" aria-hidden="true" tabindex="-1"></a>B</span></code></pre></div>
<pre><code>## torch_tensor
##  0.5134  0.7426  0.7159
##  0.5705  0.1653  0.0443
## [ CPUFloatType{2,3} ]</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="operation.html#cb40-1" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> C[<span class="dv">1</span>,,]</span>
<span id="cb40-2"><a href="operation.html#cb40-2" aria-hidden="true" tabindex="-1"></a>D</span></code></pre></div>
<pre><code>## torch_tensor
##  0.9628  0.2943
##  0.0992  0.8096
##  0.0169  0.8222
## [ CPUFloatType{3,2} ]</code></pre>
<p>í…ì„œì˜ ê³±ì…ˆì€ <code>torch_matmul()</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="operation.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># íŒŒì´í”„ ì‚¬ìš©í•´ë„ ë¬´ë°©í•˜ë‹¤.</span></span>
<span id="cb42-2"><a href="operation.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># B %&gt;% torch_matmul(D)</span></span>
<span id="cb42-3"><a href="operation.html#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">torch_matmul</span>(B, D)</span></code></pre></div>
<pre><code>## torch_tensor
##  0.5800  1.3409
##  0.5664  0.3381
## [ CPUFloatType{2,2} ]</code></pre>
<p>í† ì¹˜ì˜ í…ì„œ ê³±ì…ˆì€ ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ë“¤ë„ ìˆìœ¼ë‹ˆ ì•Œì•„ë‘ì.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="operation.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">torch_mm</span>(B, D)</span></code></pre></div>
<pre><code>## torch_tensor
##  0.5800  1.3409
##  0.5664  0.3381
## [ CPUFloatType{2,2} ]</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="operation.html#cb46-1" aria-hidden="true" tabindex="-1"></a>B<span class="sc">$</span><span class="fu">mm</span>(D)</span></code></pre></div>
<pre><code>## torch_tensor
##  0.5800  1.3409
##  0.5664  0.3381
## [ CPUFloatType{2,2} ]</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="operation.html#cb48-1" aria-hidden="true" tabindex="-1"></a>B<span class="sc">$</span><span class="fu">matmul</span>(D)</span></code></pre></div>
<pre><code>## torch_tensor
##  0.5800  1.3409
##  0.5664  0.3381
## [ CPUFloatType{2,2} ]</code></pre>
</div>
<div id="í…ì„œì˜-ì „ì¹˜transpose" class="section level3" number="3.2.7">
<h3><span class="header-section-number">3.2.7</span> í…ì„œì˜ ì „ì¹˜(transpose)</h3>
<p>ì „ì¹˜(transpose)ëŠ” ì£¼ì–´ì§„ í…ì„œë¥¼ ë’¤ì§‘ëŠ” ê²ƒì¸ë°, ë‹¤ìŒì˜ ë¬¸ë²• êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆë‹¤.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="operation.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">torch_transpose</span>(input, dim0, dim1)</span></code></pre></div>
<p><code>dim0</code>, <code>dim1</code>ëŠ” ë°”ê¿€ ì°¨ì›ì„ ì˜ë¯¸í•œë‹¤. â€˜ë°”ê¿€ ì°¨ì›ì€ ë‘ ê°œ ë°–ì— ì—†ì§€ ì•Šë‚˜?â€™ ë¼ê³  ìƒê°í•  ìˆ˜ ìˆë‹¤. 2 ì°¨ì› í…ì„œì˜ ê²½ìš°ì—ëŠ” ê·¸ë ‡ë‹¤. ìš°ë¦¬ê°€ í–‰ë ¬ì„ ì „ì¹˜í•˜ëŠ” ê²½ìš°ì—ëŠ” transposeë¥¼ ì·¨í•˜ëŠ” ëŒ€ìƒì´ 2ì°¨ì›ì´ë¯€ë¡œ ì§€ì •í•´ì£¼ëŠ” ì°¨ì›ì´ ì •í•´ì ¸ìˆë‹¤. í•˜ì§€ë§Œ, í…ì„œì˜ ì°¨ì›ì´ 3ì°¨ì› ì´ìƒì´ ë˜ë©´ ì „ì¹˜ë¥¼ í•´ì£¼ëŠ” ì°¨ì›ì„ ì§€ì •í•´ì¤˜ì•¼í•œë‹¤.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="operation.html#cb51-1" aria-hidden="true" tabindex="-1"></a>A</span></code></pre></div>
<pre><code>## torch_tensor
##  1  2  3
##  4  5  6
## [ CPUDoubleType{2,3} ]</code></pre>
<p>ìœ„ì˜ í…ì„œ Aì˜ ì°¨ì›ì€ í–‰ê³¼ ì—´, ì¦‰, 2ê°œì´ë‹¤. ë‹¤ìŒì˜ ì½”ë“œë“¤ì€ A í…ì„œì˜ ì²«ë²ˆì§¸ ì°¨ì›ê³¼ ë‘ë²ˆì§¸ ì°¨ì›ì„ ë’¤ì§‘ëŠ” íš¨ê³¼ë¥¼ ê°€ì ¸ì˜¨ë‹¤. ì¦‰, ì „ì¹˜ í…ì„œê°€ ëœë‹¤.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="operation.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">torch_transpose</span>(A, <span class="dv">1</span>, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## torch_tensor
##  1  4
##  2  5
##  3  6
## [ CPUDoubleType{3,2} ]</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="operation.html#cb55-1" aria-hidden="true" tabindex="-1"></a>A<span class="sc">$</span><span class="fu">transpose</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## torch_tensor
##  1  4
##  2  5
##  3  6
## [ CPUDoubleType{3,2} ]</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="operation.html#cb57-1" aria-hidden="true" tabindex="-1"></a>A <span class="sc">%&gt;%</span> <span class="fu">torch_transpose</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## torch_tensor
##  1  4
##  2  5
##  3  6
## [ CPUDoubleType{3,2} ]</code></pre>
<p>3ì°¨ì›ì˜ í…ì„œë¥¼ ì‚´í´ë³´ì.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="operation.html#cb59-1" aria-hidden="true" tabindex="-1"></a>C</span></code></pre></div>
<pre><code>## torch_tensor
## (1,.,.) = 
##   0.9628  0.2943
##   0.0992  0.8096
##   0.0169  0.8222
## 
## (2,.,.) = 
##   0.1242  0.7489
##   0.3608  0.5131
##   0.2959  0.7834
## [ CPUFloatType{2,3,2} ]</code></pre>
<p>í…ì„œ CëŠ” ìœ„ì™€ ê°™ì´ 2ì°¨ì› í…ì„œê°€ ë‘ ê°œ í¬ê°œì ¸ ìˆë‹¤ê³  ìƒê°í•˜ë©´ ëœë‹¤. í…ì„œì˜ ê²°ê³¼ë¬¼ì„ ì˜ ì‚´í´ë³´ë©´, ì œì¼ ì•ì— ìœ„ì¹˜í•œ 1, 2ê°€ ë‚˜íƒ€ë‚´ëŠ” ê²ƒì´ ìš°ë¦¬ê°€ í”íˆ ìƒê°í•˜ëŠ” í–‰ë ¬ë“¤ì˜ ìƒ‰ì¸(index) ì—­í• ì„ í•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="operation.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">torch_transpose</span>(C, <span class="dv">2</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## torch_tensor
## (1,.,.) = 
##   0.9628  0.0992  0.0169
##   0.2943  0.8096  0.8222
## 
## (2,.,.) = 
##   0.1242  0.3608  0.2959
##   0.7489  0.5131  0.7834
## [ CPUFloatType{2,2,3} ]</code></pre>
<p>ì´ ë¶€ë¶„ì—ì„œ <a href="https://rstudio.github.io/reticulate/articles/arrays.html">Rì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µí•˜ëŠ” arrayì˜ ë¬¸ë²•ê³¼ ì°¨ì´ê°€ ë°œìƒ</a>í•˜ëŠ”ë°, ë‹¤ìŒì˜ ì½”ë“œë¥¼ ì‚´í´ë³´ì. ë¨¼ì € Rì—ì„œ 2í–‰ 3ì—´ì˜ í–‰ë ¬ì„ ë‘ ê°œ í¬ê°œì–´ ë†“ì€ 3ì°¨ì› ë°°ì—´ì„ ë§Œë“œëŠ” ì½”ë“œì´ë‹¤.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="operation.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">array</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>)) </span></code></pre></div>
<pre><code>## , , 1
## 
##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]    2    4    6
## 
## , , 2
## 
##      [,1] [,2] [,3]
## [1,]    7    9   11
## [2,]    8   10   12</code></pre>
<p>í•„ìëŠ” ì°¸ê³ ë¡œ <code>matrix()</code>ë¥¼ ë§Œë“¤ë•Œì—ë„ <code>byrow</code> ì˜µì…˜ì„ ì¨ì„œ ë§Œë“œëŠ” ê²ƒì„ ì¢‹ì•„í•˜ëŠ”ë°, <code>array()</code>ì—ì„œ <code>byrow</code> ì˜µì…˜ íš¨ê³¼ë¥¼ ì ìš©í•˜ë ¤ë©´ <code>aperm()</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ë”°ë¼ì„œ, ì¢€ ë” ì§ê´€ì ìœ¼ë¡œ ì“°ê¸°ìœ„í•´ì„œ ë‹¤ìŒì˜ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="operation.html#cb65-1" aria-hidden="true" tabindex="-1"></a>array_3d_byrow <span class="ot">&lt;-</span> <span class="cf">function</span>(num_vec, nrow, ncol, ndeath){</span>
<span id="cb65-2"><a href="operation.html#cb65-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aperm</span>(<span class="fu">array</span>(num_vec, <span class="fu">c</span>(ncol, nrow, ndeath)), <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>))    </span>
<span id="cb65-3"><a href="operation.html#cb65-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-4"><a href="operation.html#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="operation.html#cb65-5" aria-hidden="true" tabindex="-1"></a>E <span class="ot">&lt;-</span> <span class="fu">array_3d_byrow</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb65-6"><a href="operation.html#cb65-6" aria-hidden="true" tabindex="-1"></a>E</span></code></pre></div>
<pre><code>## , , 1
## 
##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    5    6
## 
## , , 2
## 
##      [,1] [,2] [,3]
## [1,]    7    8    9
## [2,]   10   11   12</code></pre>
<p>ì´ëŸ¬í•œ ì½”ë“œë¥¼ ì•ì„œ ë°°ì› ë˜ <code>torch_tensor()</code> í•¨ìˆ˜ì— ë„£ì–´ë³´ì.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="operation.html#cb67-1" aria-hidden="true" tabindex="-1"></a>E <span class="sc">%&gt;%</span> <span class="fu">torch_tensor</span>()</span></code></pre></div>
<pre><code>## torch_tensor
## (1,.,.) = 
##   1  7
##   2  8
##   3  9
## 
## (2,.,.) = 
##    4  10
##    5  11
##    6  12
## [ CPULongType{2,3,2} ]</code></pre>
<p>ê²°ê³¼ë¥¼ ì‚´í´ë³´ë©´, ìš°ë¦¬ê°€ ì˜ˆìƒí–ˆë˜ 2í–‰ 3ì—´ì˜ í…ì„œê°€ ë‘ê°œ ê²¹ì³ìˆëŠ” í…ì„œì˜ ëª¨ì–‘ì´ ë‚˜ì˜¤ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì´ìœ ëŠ” <code>torch</code>ì—ì„œ ì •ì˜ëœ 3ì°¨ì› í…ì„œì˜ ê²½ìš°, ì²«ë²ˆì§¸ ì°¨ì›ì´ í…ì„œê°€ ì–¼ë§ˆë‚˜ ê²¹ì³ìˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê¹Šì´(depth)ë¥¼ ë‚˜íƒ€ë‚´ê¸° ë•Œë¬¸ì´ë‹¤. ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œëŠ” <code>aperm()</code> ì‚¬ìš©í•´ì„œ ì°¨ì›ì„ ë°”ê¿”ì£¼ë©´ ëœë‹¤.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="operation.html#cb69-1" aria-hidden="true" tabindex="-1"></a>E <span class="sc">%&gt;%</span> </span>
<span id="cb69-2"><a href="operation.html#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aperm</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> <span class="co"># 3 ë²ˆì§¸ ì°¨ì›ì„ ë§¨ ì•ìœ¼ë¡œ, ë‚˜ë¨¸ì§€ëŠ” ê·¸ëŒ€ë¡œ</span></span>
<span id="cb69-3"><a href="operation.html#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">torch_tensor</span>()</span></code></pre></div>
<pre><code>## torch_tensor
## (1,.,.) = 
##   1  2  3
##   4  5  6
## 
## (2,.,.) = 
##    7   8   9
##   10  11  12
## [ CPULongType{2,2,3} ]</code></pre>
<p>ìœ„ì˜ ê²½ìš°ë¥¼ ì¢€ë” ì§ê´€ì ì¸ í•¨ìˆ˜ëª…ìœ¼ë¡œ ë°”ê¿”ì„œ ì‚¬ìš©í•˜ë„ë¡ í•˜ì. ğŸ˜‚</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="operation.html#cb71-1" aria-hidden="true" tabindex="-1"></a>array_to_torch <span class="ot">&lt;-</span> <span class="cf">function</span>(mat, <span class="at">n_dim =</span> <span class="dv">3</span>){</span>
<span id="cb71-2"><a href="operation.html#cb71-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">torch_tensor</span>(<span class="fu">aperm</span>(mat, <span class="fu">c</span>(n_dim<span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>)))</span>
<span id="cb71-3"><a href="operation.html#cb71-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-4"><a href="operation.html#cb71-4" aria-hidden="true" tabindex="-1"></a>E <span class="ot">&lt;-</span> <span class="fu">array_to_torch</span>(E)</span>
<span id="cb71-5"><a href="operation.html#cb71-5" aria-hidden="true" tabindex="-1"></a>E</span></code></pre></div>
<pre><code>## torch_tensor
## (1,.,.) = 
##   1  2  3
##   4  5  6
## 
## (2,.,.) = 
##    7   8   9
##   10  11  12
## [ CPULongType{2,2,3} ]</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/statisticsplaybook/r-torch-playbook/edit/master/02-tensor-calculation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
