[["operation.html", "Chapter 3 í…ì„œ (tensor) ì—°ì‚° 3.1 í† ì¹˜ (torch) ë¶ˆëŸ¬ì˜¤ê¸° ë° ì¤€ë¹„ë¬¼ ì¤€ë¹„ 3.2 í…ì„œì˜ ì—°ì‚°", " Chapter 3 í…ì„œ (tensor) ì—°ì‚° ì§€ë‚œ ì±•í„°ì—ì„œ ìš°ë¦¬ëŠ” í…ì„œê°€ í–‰ë ¬ì˜ ì—°ì‚°ì— ì ìš©ë˜ëŠ” %*%ê³¼ í˜¸í™˜ì´ ë˜ì§€ ì•ŠëŠ” ë‹¤ëŠ” ê²ƒì„ ì•Œê²Œë˜ì—ˆë‹¤. ì´ë²ˆ ì±•í„°ì—ì„œëŠ” í…ì„œë“¤ì˜ ì—°ì‚°ì— ëŒ€í•˜ì—¬ ì•Œì•„ë³´ë„ë¡ í•˜ì. 3.1 í† ì¹˜ (torch) ë¶ˆëŸ¬ì˜¤ê¸° ë° ì¤€ë¹„ë¬¼ ì¤€ë¹„ í† ì¹˜ (torch) ë¥¼ ë¶ˆëŸ¬ì˜¤ê³ , ì´ë²ˆ ì±•í„°ì— ì‚¬ìš©ë  í…ì„œ A, B, ê·¸ë¦¬ê³  Cë¥¼ ì¤€ë¹„í•˜ì. ì§€ë‚œ ì±•í„°ì—ì„œ ë°°ìš´ ë‚œìˆ˜ë¥¼ ì´ìš©í•œ í…ì„œë„ ë§Œë“¤ ì˜ˆì •ì´ë‹ˆ ë‚œìˆ˜ë¥¼ ê³ ì •í•œë‹¤. library(torch) # ë‚œìˆ˜ ìƒì„± ì‹œë“œ ê³ ì • torch_manual_seed(2021) A &lt;- torch_tensor(1:6) B &lt;- torch_rand(2, 3) C &lt;- torch_rand(2, 3, 2) A; B; C ## torch_tensor ## 1 ## 2 ## 3 ## 4 ## 5 ## 6 ## [ CPULongType{6} ] ## torch_tensor ## 0.5134 0.7426 0.7159 ## 0.5705 0.1653 0.0443 ## [ CPUFloatType{2,3} ] ## torch_tensor ## (1,.,.) = ## 0.9628 0.2943 ## 0.0992 0.8096 ## 0.0169 0.8222 ## ## (2,.,.) = ## 0.1242 0.7489 ## 0.3608 0.5131 ## 0.2959 0.7834 ## [ CPUFloatType{2,3,2} ] ë§Œë“¤ì–´ì§„ ì„¸ ê°œì˜ í…ì„œ ê²°ê³¼ë¥¼ ì‚´í´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤. í…ì„œ A: ì •ìˆ˜ë“¤ë¡œ êµ¬ì„±ì´ ë˜ì–´ìˆê³ , 6ê°œì˜ ì›ì†Œë“¤ì´ ë²¡í„°ë¥¼ ì´ë£¨ê³  ìˆë‹¤. í…ì„œ B: ì‹¤ìˆ˜ë“¤ë¡œ êµ¬ì„±ì´ ë˜ì–´ìˆê³ , ë˜‘ê°™ì´ 6ê°œì˜ ì›ì†Œë“¤ì´ ìˆì§€ë§Œ, ëª¨ì–‘ì´ 4í–‰ 3ì—´ì¸ 2ì°¨ì› í–‰ë ¬ì˜ ëª¨ì–‘ì„ í•˜ê³  ìˆë‹¤. í…ì„œ C: ì‹¤ìˆ˜ë“¤ë¡œ êµ¬ì„±ì´ ë˜ì–´ìˆê³ , ì´ ì›ì†Œ ê°¯ìˆ˜ëŠ” 12ê°œì§€ë§Œ, ëª¨ì–‘ì€ 3í–‰ 2ì—´ì˜ í–‰ë ¬ì´ ë‘ê°œê°€ ìŒ“ì—¬ì§„ ê¼´ì˜ 3ì°¨ì› ë°°ì—´ (array) ì´ë‹¤. 3.2 í…ì„œì˜ ì—°ì‚° 3.2.1 í˜•(type) ë³€í™˜ ë¨¼ì € ì£¼ëª©í•´ì•¼ í•  ê²ƒì€ ë°”ë¡œ í…ì„œ Aì™€ Bì˜ ìë£Œí˜•ì´ ë‹¤ë¥´ë‹¤ëŠ” ê²ƒì´ë‹¤. ì´ê²Œ ë¬´ìŠ¨ëœ»ì´ëƒë©´ Aì—ëŠ” ì •ìˆ˜ë§Œì´ ë‹´ê¸¸ ìˆ˜ ìˆê³ , Bì—ëŠ” ì‹¤ìˆ˜ë§Œì´ ë‹´ê¸¸ ìˆ˜ ìˆë„ë¡ ì„¤ê³„ê°€ ë˜ì–´ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ì•ì—ì„œ í™•ì¸í•œ ìë£Œí˜•ì„ ì¢€ ë” ëª…í™•í•˜ê²Œ í™•ì¸í•˜ê¸° ìœ„í•´ì„œëŠ” type() ì‚¬ìš©í•œë‹¤. A$dtype ## torch_Long B$dtype ## torch_Float í…ì„œ Aë¥¼ ì‹¤ìˆ˜í˜• í…ì„œë¡œ ë°”ê¿”ë³´ì. í…ì„œì˜ í˜•ì„ ë³€í™˜í•  ë•Œì—ëŠ” Aí…ì„œ ì•ˆì— ì†ì„±ìœ¼ë¡œ ë“¤ì–´ê°€ìˆëŠ” to() í•¨ìˆ˜ë¥¼ ì‚¬ìš© (ì¢€ ë” ì–´ë ¤ìš´ ê´€ì ì—ì„œëŠ” OOPì˜ methodë¥¼ ì‚¬ìš©) í•´ì„œ ë°”ê¿”ì¤„ ìˆ˜ ìˆë‹¤. A &lt;- A$to(dtype = torch_double()) A ## torch_tensor ## 1 ## 2 ## 3 ## 4 ## 5 ## 6 ## [ CPUDoubleType{6} ] torchì—ëŠ” ì •ë§ ë§ì€ ìë£Œí˜•ì´ ìˆëŠ”ë°, ê·¸ ëª©ë¡ì€ ë‹¤ìŒì„ ì°¸ê³ í•˜ì. 3.2.2 ëª¨ì–‘ ë³€í™˜ ì•ì—ì„œ í…ì„œ Aë¥¼ Bì™€ ê°™ì€ ì‹¤ìˆ˜ë¥¼ ë‹´ì„ ìˆ˜ ìˆëŠ” í˜•ìœ¼ë¡œ ë°”ê¾¸ì—ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì´ ë‘ ê°œë¥¼ ë”í•  ìˆ˜ ìˆì„ê¹Œ? ë‹µì€ â€œì•„ë‹ˆì˜¬ì‹œë‹¤.â€ ì´ë‹¤. ì™œëƒí•˜ë©´ ëª¨ì–‘ì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì´ë‹¤. A + B ## Error in (function (self, other, alpha) : The size of tensor a (6) must match the size of tensor b (3) at non-singleton dimension 1 ## Exception raised from infer_size at ../aten/src/ATen/ExpandUtils.cpp:24 (most recent call first): ## frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;) + 0x69 (0x7f086041eb89 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libc10.so) ## frame #1: at::infer_size(c10::ArrayRef&lt;long&gt;, c10::ArrayRef&lt;long&gt;) + 0x552 (0x7f084ff6d382 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so) ## frame #2: at::TensorIterator::compute_shape(at::TensorIteratorConfig const&amp;) + 0xde (0x7f085046fc2e in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so) ## frame #3: at::TensorIterator::build(at::TensorIteratorConfig&amp;) + 0x64 (0x7f08504721e4 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so) ## frame #4: at::TensorIterator::TensorIterator(at::TensorIteratorConfig&amp;) + 0xdd (0x7f085047299d in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so) ## frame #5: at::TensorIterator::binary_op(at::Tensor&amp;, at::Tensor const&amp;, at::Tensor const&amp;) + 0x130 (0x7f0850472b30 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so) ## frame #6: at::native::add(at::Tensor const&amp;, at::Tensor const&amp;, c10::Scalar) + 0x53 (0x7f0850125bc3 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so) ## frame #7: &lt;unknown function&gt; + 0x13311bd (0x7f085078c1bd in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so) ## frame #8: &lt;unknown function&gt; + 0xaf2045 (0x7f084ff4d045 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so) ## frame #9: at::Tensor c10::Dispatcher::callWithDispatchKey&lt;at::Tensor, at::Tensor const&amp;, at::Tensor const&amp;, c10::Scalar&gt;(c10::TypedOperatorHandle&lt;at::Tensor (at::Tensor const&amp;, at::Tensor const&amp;, c10::Scalar)&gt; const&amp;, c10::DispatchKey, at::Tensor const&amp;, at::Tensor const&amp;, c10::Scalar) const + 0x27f (0x7f085093781f in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so) ## frame #10: at::add(at::Tensor const&amp;, at::Tensor const&amp;, c10::Scalar) + 0x123 (0x7f085082dfd3 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so) ## frame #11: &lt;unknown function&gt; + 0x2a0f2bb (0x7f0851e6a2bb in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so) ## frame #12: &lt;unknown function&gt; + 0xaf2045 (0x7f084ff4d045 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so) ## frame #13: at::Tensor c10::Dispatcher::callWithDispatchKey&lt;at::Tensor, at::Tensor const&amp;, at::Tensor const&amp;, c10::Scalar&gt;(c10::TypedOperatorHandle&lt;at::Tensor (at::Tensor const&amp;, at::Tensor const&amp;, c10::Scalar)&gt; const&amp;, c10::DispatchKey, at::Tensor const&amp;, at::Tensor const&amp;, c10::Scalar) const + 0x27f (0x7f085093781f in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so) ## frame #14: at::add(at::Tensor const&amp;, at::Tensor const&amp;, c10::Scalar) + 0x123 (0x7f085082dfd3 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/./libtorch_cpu.so) ## frame #15: _lantern_add_tensor_tensor_scalar + 0x64 (0x7f08607a00e4 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/deps/liblantern.so) ## frame #16: cpp_torch_namespace_add_self_Tensor_other_Tensor(Rcpp::XPtr&lt;XPtrTorchTensor, Rcpp::PreserveStorage, &amp;(void Rcpp::standard_delete_finalizer&lt;XPtrTorchTensor&gt;(XPtrTorchTensor*)), false&gt;, Rcpp::XPtr&lt;XPtrTorchTensor, Rcpp::PreserveStorage, &amp;(void Rcpp::standard_delete_finalizer&lt;XPtrTorchTensor&gt;(XPtrTorchTensor*)), false&gt;, Rcpp::XPtr&lt;XPtrTorchScalar, Rcpp::PreserveStorage, &amp;(void Rcpp::standard_delete_finalizer&lt;XPtrTorchScalar&gt;(XPtrTorchScalar*)), false&gt;) + 0x48 (0x7f08610e5fe8 in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/libs/torchpkg.so) ## frame #17: _torch_cpp_torch_namespace_add_self_Tensor_other_Tensor + 0x9c (0x7f0860e7e00c in /home/issac/R/x86_64-pc-linux-gnu-library/4.0/torch/libs/torchpkg.so) ## frame #18: &lt;unknown function&gt; + 0xf9310 (0x7f0874173310 in /usr/lib/R/lib/libR.so) ## frame #19: &lt;unknown function&gt; + 0xf9826 (0x7f0874173826 in /usr/lib/R/lib/libR.so) ## frame #20: &lt;unknown function&gt; + 0x137106 (0x7f08741b1106 in /usr/lib/R/lib/libR.so) ## frame #21: Rf_eval + 0x180 (0x7f08741bd6f0 in /usr/lib/R/lib/libR.so) ## frame #22: &lt;unknown function&gt; + 0x14550f (0x7f08741bf50f in /usr/lib/R/lib/libR.so) ## frame #23: Rf_applyClosure + 0x1c7 (0x7f08741c02d7 in /usr/lib/R/lib/libR.so) ## frame #24: Rf_eval + 0x353 (0x7f08741bd8c3 in /usr/lib/R/lib/libR.so) ## frame #25: &lt;unknown function&gt; + 0xc650d (0x7f087414050d in /usr/lib/R/lib/libR.so) ## frame #26: &lt;unknown function&gt; + 0x137106 (0x7f08741b1106 in /usr/lib/R/lib/libR.so) ## frame #27: Rf_eval + 0x180 (0x7f08741bd6f0 in /usr/lib/R/lib/libR.so) ## frame #28: &lt;unknown function&gt; + 0x14550f (0x7f08741bf50f in /usr/lib/R/lib/libR.so) ## frame #29: Rf_applyClosure + 0x1c7 (0x7f08741c02d7 in /usr/lib/R/lib/libR.so) ## frame #30: &lt;unknown function&gt; + 0x13a989 (0x7f08741b4989 in /usr/lib/R/lib/libR.so) ## frame #31: Rf_eval + 0x180 (0x7f08741bd6f0 in /usr/lib/R/lib/libR.so) ## frame #32: &lt;unknown function&gt; + 0x14550f (0x7f08741bf50f in /usr/lib/R/lib/libR.so) ## frame #33: Rf_applyClosure + 0x1c7 (0x7f08741c02d7 in /usr/lib/R/lib/libR.so) ## frame #34: &lt;unknown function&gt; + 0x13a989 (0x7f08741b4989 in /usr/lib/R/lib/libR.so) ## frame #35: Rf_eval + 0x180 (0x7f08741bd6f0 in /usr/lib/R/lib/libR.so) ## frame #36: &lt;unknown function&gt; + 0x14550f (0x7f08741bf50f in /usr/lib/R/lib/libR.so) ## frame #37: Rf_applyClosure + 0x1c7 (0x7f08741c02d7 in /usr/lib/R/lib/libR.so) ## frame #38: &lt;unknown function&gt; + 0x13a989 (0x7f08741b4989 in /usr/lib/R/lib/libR.so) ## frame #39: Rf_eval + 0x180 (0x7f08741bd6f0 in /usr/lib/R/lib/libR.so) ## frame #40: &lt;unknown function&gt; + 0x14550f (0x7f08741bf50f in /usr/lib/R/lib/libR.so) ## frame #41: Rf_applyClosure + 0x1c7 (0x7f08741c02d7 in /usr/lib/R/lib/libR.so) ## frame #42: &lt;unknown function&gt; + 0x13a989 (0x7f08741b4989 in /usr/lib/R/lib/libR.so) ## frame #43: Rf_eval + 0x180 (0x7f08741bd6f0 in /usr/lib/R/lib/libR.so) ## frame #44: &lt;unknown function&gt; + 0x14550f (0x7f08741bf50f in /usr/lib/R/lib/libR.so) ## frame #45: Rf_applyClosure + 0x1c7 (0x7f08741c02d7 in /usr/lib/R/lib/libR.so) ## frame #46: &lt;unknown function&gt; + 0x12d83b (0x7f08741a783b in /usr/lib/R/lib/libR.so) ## frame #47: &lt;unknown function&gt; + 0x9021b (0x7f087410a21b in /usr/lib/R/lib/libR.so) ## frame #48: Rf_eval + 0x706 (0x7f08741bdc76 in /usr/lib/R/lib/libR.so) ## frame #49: &lt;unknown function&gt; + 0x149782 (0x7f08741c3782 in /usr/lib/R/lib/libR.so) ## frame #50: &lt;unknown function&gt; + 0x137106 (0x7f08741b1106 in /usr/lib/R/lib/libR.so) ## frame #51: Rf_eval + 0x180 (0x7f08741bd6f0 in /usr/lib/R/lib/libR.so) ## frame #52: &lt;unknown function&gt; + 0x14550f (0x7f08741bf50f in /usr/lib/R/lib/libR.so) ## frame #53: Rf_applyClosure + 0x1c7 (0x7f08741c02d7 in /usr/lib/R/lib/libR.so) ## frame #54: &lt;unknown function&gt; + 0x13a989 (0x7f08741b4989 in /usr/lib/R/lib/libR.so) ## frame #55: Rf_eval + 0x180 (0x7f08741bd6f0 in /usr/lib/R/lib/libR.so) ## frame #56: &lt;unknown function&gt; + 0x1440ac (0x7f08741be0ac in /usr/lib/R/lib/libR.so) ## frame #57: Rf_eval + 0x454 (0x7f08741bd9c4 in /usr/lib/R/lib/libR.so) ## frame #58: &lt;unknown function&gt; + 0x14a22c (0x7f08741c422c in /usr/lib/R/lib/libR.so) ## frame #59: &lt;unknown function&gt; + 0x1871fd (0x7f08742011fd in /usr/lib/R/lib/libR.so) ## frame #60: &lt;unknown function&gt; + 0x1353c4 (0x7f08741af3c4 in /usr/lib/R/lib/libR.so) ## frame #61: Rf_eval + 0x180 (0x7f08741bd6f0 in /usr/lib/R/lib/libR.so) ## frame #62: &lt;unknown function&gt; + 0x14550f (0x7f08741bf50f in /usr/lib/R/lib/libR.so) ## frame #63: Rf_applyClosure + 0x1c7 (0x7f08741c02d7 in /usr/lib/R/lib/libR.so) ëª¨ì–‘ì´ ë‹¤ë¥¸ í…ì„œë¥¼ ë”í•˜ë ¤ê³  í•˜ë©´ Rì€ ìœ„ì—ì„œ ë³´ë“¯ ë„ˆë¬´ë‚˜ ë§ì€ ì—ëŸ¬ë¥¼ ìŸì•„ë‚¸ë‹¤. ëª¨ì–‘ì´ ë‹¤ë¥¸ ë‘ í…ì„œë¥¼ ë”í•˜ê¸° ìœ„í•´ì„œëŠ” ëª¨ì–‘ì„ ê°™ê²Œ ë§ì¶°ì¤˜ì•¼ í•œë‹¤. Aì˜ ëª¨ì–‘ì„ Bì˜ ëª¨ì–‘ê³¼ ê°™ì´ ë°”ê¿”ë³´ë„ë¡ í•˜ì. ëª¨ì–‘ì„ ë°”ê¿€ë•ŒëŠ” view() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê³ , ì•ˆì— ëª¨ì–‘ì˜ í˜•íƒœë¥¼ ë²¡í„° í˜•ì‹ìœ¼ë¡œ ì§šì–´ ë„£ëŠ”ë‹¤ëŠ” ê²ƒì„ ê¸°ì–µí•˜ì. A &lt;- A$view(c(2, 3)) A ## torch_tensor ## 1 2 3 ## 4 5 6 ## [ CPUDoubleType{2,3} ] 3.2.3 ë§ì…ˆê³¼ ëº„ì…ˆ ì•ì—ì„œ í˜•(type)ê³¼ ëª¨ì–‘(shape)ê¹Œì§€ ë§ì¶°ë†¨ìœ¼ë‹ˆ, í…ì„œë¼ë¦¬ì˜ ë§ì…ˆê³¼ ëº„ì…ˆì„ í•  ìˆ˜ ìˆë‹¤. A + B ## torch_tensor ## 1.5134 2.7426 3.7159 ## 4.5705 5.1653 6.0443 ## [ CPUDoubleType{2,3} ] A - B ## torch_tensor ## 0.4866 1.2574 2.2841 ## 3.4295 4.8347 5.9557 ## [ CPUDoubleType{2,3} ] ì‚¬ì‹¤, í…ì„œë¼ë¦¬ì˜ ì—°ì‚°ì€ ëª¨ì–‘ë§Œ ë§ìœ¼ë©´ ê°€ëŠ¥í•˜ë‹¤. ì¦‰, ë‹¤ìŒì˜ ì—°ì‚°ì´ ì„±ë¦½í•œë‹¤. A_ &lt;- A$to(dtype = torch_long()) A_ + B ## torch_tensor ## 1.5134 2.7426 3.7159 ## 4.5705 5.1653 6.0443 ## [ CPUFloatType{2,3} ] ê²°ê³¼ì—ì„œ ì•Œ ìˆ˜ ìˆë“¯, ì •ìˆ˜ë¥¼ ë‹´ì„ ìˆ˜ ìˆëŠ” í…ì„œì™€ ì‹¤ìˆ˜ë¥¼ ë‹´ì„ ìˆ˜ ìˆëŠ” í…ì„œë¥¼ ë”í•˜ë©´, ê²°ê³¼ëŠ” ì‹¤ìˆ˜ë¥¼ ë‹´ì„ ìˆ˜ ìˆëŠ” í…ì„œë¡œ ë°˜í™˜ì´ ëœë‹¤. í•˜ì§€ë§Œ, í•„ìëŠ” ì´ëŸ¬í•œ ì½”ë”©ì€ í”¼í•´ì•¼ í•œë‹¤ê³  ìƒê°í•œë‹¤. ì¦‰, ëª¨ë“  ì—°ì‚°ì„ í•  ê²½ìš°, ëª…ì‹œì ìœ¼ë¡œ í˜•ë³€í™˜ì„ í•œ í›„ ì—°ì‚°ì„ í•  ê²ƒì„ ê¶Œí•œë‹¤. ì™œëƒí•˜ë©´, ì–¸ì œë‚˜ ìš°ë¦¬ëŠ” ì½”ë“œë¥¼ ë‹¤ë¥¸ ì‚¬ëŒì´ ë³´ì•˜ì„ ë•Œ, ì´í•´í•˜ê¸° ì‰½ë„ë¡ ì§œëŠ” ê²ƒì„ ì¶”êµ¬í•´ì•¼ í•œë‹¤. (ì½”ë“œëŠ” í•˜ë‚˜ì˜ ìì‹ ì˜ ìƒê°ì„ ì ì€ ê¸€ì´ë‹¤.) 3.2.4 ìƒìˆ˜ì™€ì˜ ì—°ì‚° Rì—ì„œì™€ ë§ˆì°¬ê°€ì§€ë¡œ, í…ì„œì™€ ìƒìˆ˜ì™€ì˜ ì‚¬ì¹™ì—°ì‚°ì€ ê° ì›ì†Œì— ì ìš©ë˜ëŠ” ê²ƒì„ í™•ì¸í•˜ì. A + 2 ## torch_tensor ## 3 4 5 ## 6 7 8 ## [ CPUDoubleType{2,3} ] B^2 ## torch_tensor ## 0.2636 0.5514 0.5125 ## 0.3254 0.0273 0.0020 ## [ CPUFloatType{2,3} ] A %/% 3 ## torch_tensor ## 0 0 1 ## 1 1 2 ## [ CPUDoubleType{2,3} ] A %% 3 ## torch_tensor ## 1 2 0 ## 1 2 0 ## [ CPUDoubleType{2,3} ] 3.2.5 ì œê³±ê·¼ê³¼ ë¡œê·¸ ì œê³±ê·¼(square root)ë‚˜ ë¡œê·¸(log) í•¨ìˆ˜ ì—­ì‹œ ê° ì›ì†Œë³„ ì ìš©ì´ ê°€ëŠ¥í•˜ë‹¤. A ## torch_tensor ## 1 2 3 ## 4 5 6 ## [ CPUDoubleType{2,3} ] torch_sqrt(A) ## torch_tensor ## 1.0000 1.4142 1.7321 ## 2.0000 2.2361 2.4495 ## [ CPUDoubleType{2,3} ] ìœ„ì˜ ì—°ì‚°ì´ ì—ëŸ¬ê°€ ë‚˜ëŠ” ì´ìœ ëŠ” Aê°€ ì •ìˆ˜ë¥¼ ë‹´ëŠ” í…ì„œì˜€ëŠ”ë°, ì—°ì‚°ì„ ìˆ˜í–‰í•œ í›„ì— ì‹¤ìˆ˜ê°€ ë‹´ê²¨ì ¸ì„œ ë‚˜ì˜¤ëŠ” ì—ëŸ¬ì´ë‹¤. Rê³¼ëŠ” ì‚¬ë­‡ë‹¤ë¥¸ ì˜ˆë¯¼í•œ ì•„ì´ torchë¥¼ ìœ„í•´ í˜•ì„ ë°”ê¿”ì¤€ í›„ì— ì—°ì‚°ì„ ì‹¤í–‰í•˜ë„ë¡ í•˜ì. torch_sqrt(A$to(dtype = torch_double())) ## torch_tensor ## 1.0000 1.4142 1.7321 ## 2.0000 2.2361 2.4495 ## [ CPUDoubleType{2,3} ] torch_log(B) ## torch_tensor ## -0.6667 -0.2977 -0.3342 ## -0.5613 -1.8002 -3.1166 ## [ CPUFloatType{2,3} ] 3.2.6 í…ì„œì˜ ê³±ì…ˆ í…ì„œì˜ ê³±ì…ˆ ì—­ì‹œ ëª¨ì–‘ì´ ë§ì•„ì•¼ í•˜ë¯€ë¡œ, 3í–‰ 2ì—´ì´ ë‘ê°œê°€ ë¶™ì–´ìˆëŠ” Cì—ì„œ ì•ì— í•œì¥ì„ ë–¼ì–´ë‚´ë„ë¡ í•˜ì. B ## torch_tensor ## 0.5134 0.7426 0.7159 ## 0.5705 0.1653 0.0443 ## [ CPUFloatType{2,3} ] D &lt;- C[1,,] D ## torch_tensor ## 0.9628 0.2943 ## 0.0992 0.8096 ## 0.0169 0.8222 ## [ CPUFloatType{3,2} ] í…ì„œì˜ ê³±ì…ˆì€ torch_matmul() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤. # íŒŒì´í”„ ì‚¬ìš©í•´ë„ ë¬´ë°©í•˜ë‹¤. # B %&gt;% torch_matmul(D) torch_matmul(B, D) ## torch_tensor ## 0.5800 1.3409 ## 0.5664 0.3381 ## [ CPUFloatType{2,2} ] í† ì¹˜ì˜ í…ì„œ ê³±ì…ˆì€ ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ë“¤ë„ ìˆìœ¼ë‹ˆ ì•Œì•„ë‘ì. torch_mm(B, D) ## torch_tensor ## 0.5800 1.3409 ## 0.5664 0.3381 ## [ CPUFloatType{2,2} ] B$mm(D) ## torch_tensor ## 0.5800 1.3409 ## 0.5664 0.3381 ## [ CPUFloatType{2,2} ] B$matmul(D) ## torch_tensor ## 0.5800 1.3409 ## 0.5664 0.3381 ## [ CPUFloatType{2,2} ] 3.2.7 í…ì„œì˜ ì „ì¹˜(transpose) ì „ì¹˜(transpose)ëŠ” ì£¼ì–´ì§„ í…ì„œë¥¼ ë’¤ì§‘ëŠ” ê²ƒì¸ë°, ë‹¤ìŒì˜ ë¬¸ë²• êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆë‹¤. torch_transpose(input, dim0, dim1) dim0, dim1ëŠ” ë°”ê¿€ ì°¨ì›ì„ ì˜ë¯¸í•œë‹¤. â€˜ë°”ê¿€ ì°¨ì›ì€ ë‘ ê°œ ë°–ì— ì—†ì§€ ì•Šë‚˜?â€™ ë¼ê³  ìƒê°í•  ìˆ˜ ìˆë‹¤. 2 ì°¨ì› í…ì„œì˜ ê²½ìš°ì—ëŠ” ê·¸ë ‡ë‹¤. ìš°ë¦¬ê°€ í–‰ë ¬ì„ ì „ì¹˜í•˜ëŠ” ê²½ìš°ì—ëŠ” transposeë¥¼ ì·¨í•˜ëŠ” ëŒ€ìƒì´ 2ì°¨ì›ì´ë¯€ë¡œ ì§€ì •í•´ì£¼ëŠ” ì°¨ì›ì´ ì •í•´ì ¸ìˆë‹¤. í•˜ì§€ë§Œ, í…ì„œì˜ ì°¨ì›ì´ 3ì°¨ì› ì´ìƒì´ ë˜ë©´ ì „ì¹˜ë¥¼ í•´ì£¼ëŠ” ì°¨ì›ì„ ì§€ì •í•´ì¤˜ì•¼í•œë‹¤. A ## torch_tensor ## 1 2 3 ## 4 5 6 ## [ CPUDoubleType{2,3} ] ìœ„ì˜ í…ì„œ Aì˜ ì°¨ì›ì€ í–‰ê³¼ ì—´, ì¦‰, 2ê°œì´ë‹¤. ë‹¤ìŒì˜ ì½”ë“œë“¤ì€ A í…ì„œì˜ ì²«ë²ˆì§¸ ì°¨ì›ê³¼ ë‘ë²ˆì§¸ ì°¨ì›ì„ ë’¤ì§‘ëŠ” íš¨ê³¼ë¥¼ ê°€ì ¸ì˜¨ë‹¤. ì¦‰, ì „ì¹˜ í…ì„œê°€ ëœë‹¤. torch_transpose(A, 1, 2) ## torch_tensor ## 1 4 ## 2 5 ## 3 6 ## [ CPUDoubleType{3,2} ] A$transpose(1, 2) ## torch_tensor ## 1 4 ## 2 5 ## 3 6 ## [ CPUDoubleType{3,2} ] A %&gt;% torch_transpose(1, 2) ## torch_tensor ## 1 4 ## 2 5 ## 3 6 ## [ CPUDoubleType{3,2} ] 3ì°¨ì›ì˜ í…ì„œë¥¼ ì‚´í´ë³´ì. C ## torch_tensor ## (1,.,.) = ## 0.9628 0.2943 ## 0.0992 0.8096 ## 0.0169 0.8222 ## ## (2,.,.) = ## 0.1242 0.7489 ## 0.3608 0.5131 ## 0.2959 0.7834 ## [ CPUFloatType{2,3,2} ] í…ì„œ CëŠ” ìœ„ì™€ ê°™ì´ 2ì°¨ì› í…ì„œê°€ ë‘ ê°œ í¬ê°œì ¸ ìˆë‹¤ê³  ìƒê°í•˜ë©´ ëœë‹¤. í…ì„œì˜ ê²°ê³¼ë¬¼ì„ ì˜ ì‚´í´ë³´ë©´, ì œì¼ ì•ì— ìœ„ì¹˜í•œ 1, 2ê°€ ë‚˜íƒ€ë‚´ëŠ” ê²ƒì´ ìš°ë¦¬ê°€ í”íˆ ìƒê°í•˜ëŠ” í–‰ë ¬ë“¤ì˜ ìƒ‰ì¸(index) ì—­í• ì„ í•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. torch_transpose(C, 2, 3) ## torch_tensor ## (1,.,.) = ## 0.9628 0.0992 0.0169 ## 0.2943 0.8096 0.8222 ## ## (2,.,.) = ## 0.1242 0.3608 0.2959 ## 0.7489 0.5131 0.7834 ## [ CPUFloatType{2,2,3} ] ì´ ë¶€ë¶„ì—ì„œ Rì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µí•˜ëŠ” arrayì˜ ë¬¸ë²•ê³¼ ì°¨ì´ê°€ ë°œìƒí•˜ëŠ”ë°, ë‹¤ìŒì˜ ì½”ë“œë¥¼ ì‚´í´ë³´ì. ë¨¼ì € Rì—ì„œ 2í–‰ 3ì—´ì˜ í–‰ë ¬ì„ ë‘ ê°œ í¬ê°œì–´ ë†“ì€ 3ì°¨ì› ë°°ì—´ì„ ë§Œë“œëŠ” ì½”ë“œì´ë‹¤. array(1:12, c(2, 3, 2)) ## , , 1 ## ## [,1] [,2] [,3] ## [1,] 1 3 5 ## [2,] 2 4 6 ## ## , , 2 ## ## [,1] [,2] [,3] ## [1,] 7 9 11 ## [2,] 8 10 12 í•„ìëŠ” ì°¸ê³ ë¡œ matrix()ë¥¼ ë§Œë“¤ë•Œì—ë„ byrow ì˜µì…˜ì„ ì¨ì„œ ë§Œë“œëŠ” ê²ƒì„ ì¢‹ì•„í•˜ëŠ”ë°, array()ì—ì„œ byrow ì˜µì…˜ íš¨ê³¼ë¥¼ ì ìš©í•˜ë ¤ë©´ aperm() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ë”°ë¼ì„œ, ì¢€ ë” ì§ê´€ì ìœ¼ë¡œ ì“°ê¸°ìœ„í•´ì„œ ë‹¤ìŒì˜ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì. array_3d_byrow &lt;- function(num_vec, nrow, ncol, ndeath){ aperm(array(num_vec, c(ncol, nrow, ndeath)), c(2, 1, 3)) } E &lt;- array_3d_byrow(1:12, 2, 3, 2) E ## , , 1 ## ## [,1] [,2] [,3] ## [1,] 1 2 3 ## [2,] 4 5 6 ## ## , , 2 ## ## [,1] [,2] [,3] ## [1,] 7 8 9 ## [2,] 10 11 12 ì´ëŸ¬í•œ ì½”ë“œë¥¼ ì•ì„œ ë°°ì› ë˜ torch_tensor() í•¨ìˆ˜ì— ë„£ì–´ë³´ì. E %&gt;% torch_tensor() ## torch_tensor ## (1,.,.) = ## 1 7 ## 2 8 ## 3 9 ## ## (2,.,.) = ## 4 10 ## 5 11 ## 6 12 ## [ CPULongType{2,3,2} ] ê²°ê³¼ë¥¼ ì‚´í´ë³´ë©´, ìš°ë¦¬ê°€ ì˜ˆìƒí–ˆë˜ 2í–‰ 3ì—´ì˜ í…ì„œê°€ ë‘ê°œ ê²¹ì³ìˆëŠ” í…ì„œì˜ ëª¨ì–‘ì´ ë‚˜ì˜¤ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì´ìœ ëŠ” torchì—ì„œ ì •ì˜ëœ 3ì°¨ì› í…ì„œì˜ ê²½ìš°, ì²«ë²ˆì§¸ ì°¨ì›ì´ í…ì„œê°€ ì–¼ë§ˆë‚˜ ê²¹ì³ìˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê¹Šì´(depth)ë¥¼ ë‚˜íƒ€ë‚´ê¸° ë•Œë¬¸ì´ë‹¤. ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œëŠ” aperm() ì‚¬ìš©í•´ì„œ ì°¨ì›ì„ ë°”ê¿”ì£¼ë©´ ëœë‹¤. E %&gt;% aperm(c(3, 1, 2)) %&gt;% # 3 ë²ˆì§¸ ì°¨ì›ì„ ë§¨ ì•ìœ¼ë¡œ, ë‚˜ë¨¸ì§€ëŠ” ê·¸ëŒ€ë¡œ torch_tensor() ## torch_tensor ## (1,.,.) = ## 1 2 3 ## 4 5 6 ## ## (2,.,.) = ## 7 8 9 ## 10 11 12 ## [ CPULongType{2,2,3} ] ìœ„ì˜ ê²½ìš°ë¥¼ ì¢€ë” ì§ê´€ì ì¸ í•¨ìˆ˜ëª…ìœ¼ë¡œ ë°”ê¿”ì„œ ì‚¬ìš©í•˜ë„ë¡ í•˜ì. ğŸ˜‚ array_to_torch &lt;- function(mat, n_dim = 3){ torch_tensor(aperm(mat, c(n_dim:3, 1, 2))) } E &lt;- array_to_torch(E) E ## torch_tensor ## (1,.,.) = ## 1 2 3 ## 4 5 6 ## ## (2,.,.) = ## 7 8 9 ## 10 11 12 ## [ CPULongType{2,2,3} ] "]]
